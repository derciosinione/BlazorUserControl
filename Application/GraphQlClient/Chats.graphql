query GetChatMessages($roomId: UUID!, $page: Int!, $pageSize: Int!) {
  allMessagesByChatRoomId(
    roomId: $roomId
    page: $page
    pageSize: $pageSize
  ) {
    hasNextPage
    hasPreviousPage
    page
    pageSize
    totalCount
    totalPages
    data {
      id
      type
      chatRoomId
      content
      sentAt
      senderEmail
      readBy {
        readAt
        user {
          email
          name
          avatarUrl
        }
      }
      sender {
        email
        name
        avatarUrl
      }
    }
  }
}

query GetAllUserRoom {
  allChatRoomByUserEmail {
    id
    name
    type
    lastMessage {
      id
      type
      content
      sentAt
    }
  }
}


subscription OnChatEvent {
  onChatEvent {
    chatRoomId
    __typename
    occurredAt
    ... on ChatRoomCreatedEvent {
      chatRoomId
      occurredAt
      room {
        id
        type
        name
        createdAt
        participants {
          userEmail
          role
        }
      }
    }
    ... on MessageReceivedEvent {
      chatRoomId
      occurredAt
      message {
        id
        type
        content
        senderEmail
        sentAt
      }
    }
    ... on MessageDeletedEvent {
      chatRoomId
      messageId
      occurredAt
    }
    ... on MessageReadEvent {
      chatRoomId
      messageIds
      occurredAt
      readBy {
        userEmail
        readAt
      }
    }
    ... on ParticipantAddedEvent {
      chatRoomId
      occurredAt
      addedParticipants {
        userEmail
        role
      }
    }
    ... on ParticipantRemovedEvent {
      chatRoomId
      occurredAt
      removedUserEmails
    }
    ... on ParticipantRoleUpdatedEvent {
      chatRoomId
      newRole
      occurredAt
      userEmail
    }
    ... on PollVoteEvent {
      chatRoomId
      messageId
      occurredAt
      poll {
        id
        question
        isMultipleChoice
        options {
          id
          text
          votes {
            id
            userEmail
            votedAt
          }
        }
      }
    }
  }
}